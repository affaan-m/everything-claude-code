---
name: verification-loop
description: Claude Codeセッションのための包括的な検証システム。
---

# 検証ループスキル

Claude Codeセッションのための包括的な検証システム。

## 使用するタイミング

このスキルを呼び出す:

- 機能または重要なコード変更を完了した後
- PRを作成する前
- 品質ゲートがパスすることを確認したいとき
- リファクタリング後

## 検証フェーズ

### フェーズ1: ビルド検証

```bash
# プロジェクトがビルドされるかチェック
npm run build 2>&1 | tail -20

# または
pnpm build 2>&1 | tail -20
```

ビルドが失敗した場合、停止して続行前に修正してください。

### フェーズ2: 型チェック

```bash
# TypeScriptプロジェクト
npx tsc --noEmit 2>&1 | head -30

# Pythonプロジェクト
pyright . 2>&1 | head -30
```

すべての型エラーを報告。重大なものは続行前に修正。

### フェーズ3: リントチェック

```bash
# JavaScript/TypeScript
npm run lint 2>&1 | head -30

# Python
ruff check . 2>&1 | head -30
```

### フェーズ4: テストスイート

```bash
# カバレッジ付きでテストを実行
npm run test -- --coverage 2>&1 | tail -50

# カバレッジ閾値をチェック
# 目標: 最低80%
```

報告:
- 合計テスト数: X
- パス: X
- 失敗: X
- カバレッジ: X%

### フェーズ5: セキュリティスキャン

```bash
# シークレットをチェック
grep -rn "sk-" --include="*.ts" --include="*.js" . 2>/dev/null | head -10
grep -rn "api_key" --include="*.ts" --include="*.js" . 2>/dev/null | head -10

# console.logをチェック
grep -rn "console.log" --include="*.ts" --include="*.tsx" src/ 2>/dev/null | head -10
```

### フェーズ6: 差分レビュー

```bash
# 何が変更されたか表示
git diff --stat
git diff HEAD~1 --name-only
```

各変更ファイルをレビュー:
- 意図しない変更
- 欠けているエラーハンドリング
- 潜在的なエッジケース

## 出力形式

すべてのフェーズを実行後、検証レポートを生成:

```
検証レポート
===========

ビルド:      [パス/失敗]
型:          [パス/失敗]（Xエラー）
リント:      [パス/失敗]（X警告）
テスト:      [パス/失敗]（X/Yパス、Z%カバレッジ）
セキュリティ: [パス/失敗]（X問題）
差分:        [X ファイル変更]

全体:        PR [準備完了/未完了]

修正すべき問題:
1. ...
2. ...
```

## 継続モード

長いセッションでは、15分ごとまたは大きな変更後に検証を実行:

```markdown
メンタルチェックポイントを設定:
- 各関数の完了後
- コンポーネントの完了後
- 次のタスクに移る前

実行: /verify
```

## フックとの統合

このスキルはPostToolUseフックを補完しますが、より深い検証を提供します。
フックは問題を即座にキャッチし、このスキルは包括的なレビューを提供します。
