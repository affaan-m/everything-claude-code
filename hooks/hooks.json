{
  "$schema": "https://json.schemastore.org/claude-code-settings.json",
  "hooks": {
    "PreToolUse": [
      {
        "matcher": "tool == \"Bash\" && tool_input.command matches \"docker exec.*-u.*--stop-after-init\"",
        "hooks": [
          {
            "type": "command",
            "command": "#!/bin/bash\ninput=$(cat)\necho '[Hook] Confirm Odoo module update command' >&2\necho '[Hook] Press Enter to continue or Ctrl+C to abort...' >&2\nread -r\necho \"$input\""
          }
        ],
        "description": "Confirm before running Odoo update commands"
      },
      {
        "matcher": "tool == \"Bash\" && tool_input.command matches \"(docker exec|odoo).*test\"",
        "hooks": [
          {
            "type": "command",
            "command": "#!/bin/bash\ninput=$(cat)\nif [ -z \"$TMUX\" ]; then\n  echo '[Hook] Consider running tests in tmux for session persistence' >&2\n  echo '[Hook] tmux new -s tests  |  tmux attach -t tests' >&2\nfi\necho \"$input\""
          }
        ],
        "description": "Reminder to use tmux for long-running test commands"
      },
      {
        "matcher": "tool == \"Bash\" && tool_input.command matches \"git push\"",
        "hooks": [
          {
            "type": "command",
            "command": "#!/bin/bash\necho '[Hook] Review changes before push...' >&2\necho '[Hook] Press Enter to continue with push or Ctrl+C to abort...' >&2\nread -r"
          }
        ],
        "description": "Pause before git push to review changes"
      },
      {
        "matcher": "tool == \"Write\" && tool_input.file_path matches \"\\\\.(md|txt)$\" && !(tool_input.file_path matches \"README\\\\.md|CLAUDE\\\\.md|AGENTS\\\\.md|CONTRIBUTING\\\\.md\")",
        "hooks": [
          {
            "type": "command",
            "command": "#!/bin/bash\ninput=$(cat)\nfile_path=$(echo \"$input\" | jq -r '.tool_input.file_path // \"\"')\n\nif [[ \"$file_path\" =~ \\.(md|txt)$ ]] && [[ ! \"$file_path\" =~ (README|CLAUDE|AGENTS|CONTRIBUTING)\\.md$ ]]; then\n  echo \"[Hook] BLOCKED: Unnecessary documentation file creation\" >&2\n  echo \"[Hook] File: $file_path\" >&2\n  echo \"[Hook] Use README.md for documentation instead\" >&2\n  exit 1\nfi\n\necho \"$input\""
          }
        ],
        "description": "Block creation of random .md files - keeps docs consolidated"
      }
    ],
    "PostToolUse": [
      {
        "matcher": "tool == \"Bash\"",
        "hooks": [
          {
            "type": "command",
            "command": "#!/bin/bash\ninput=$(cat)\ncmd=$(echo \"$input\" | jq -r '.tool_input.command')\n\nif echo \"$cmd\" | grep -qE 'gh pr create'; then\n  output=$(echo \"$input\" | jq -r '.tool_output.output // \"\"')\n  pr_url=$(echo \"$output\" | grep -oE 'https://github.com/[^/]+/[^/]+/pull/[0-9]+')\n  \n  if [ -n \"$pr_url\" ]; then\n    echo \"[Hook] PR created: $pr_url\" >&2\n    echo \"[Hook] Checking GitHub Actions status...\" >&2\n  fi\nfi\n\necho \"$input\""
          }
        ],
        "description": "Log PR URL after PR creation"
      },
      {
        "matcher": "tool == \"Edit\" && tool_input.file_path matches \"\\\\.py$\"",
        "hooks": [
          {
            "type": "command",
            "command": "#!/bin/bash\ninput=$(cat)\nfile_path=$(echo \"$input\" | jq -r '.tool_input.file_path // \"\"')\n\nif [ -n \"$file_path\" ] && [ -f \"$file_path\" ]; then\n  if command -v flake8 >/dev/null 2>&1; then\n    flake8 \"$file_path\" --max-line-length=120 2>&1 | head -10 >&2 || true\n  fi\nfi\n\necho \"$input\""
          }
        ],
        "description": "Run flake8 on Python files after edit"
      },
      {
        "matcher": "tool == \"Edit\" && tool_input.file_path matches \"\\\\.py$\"",
        "hooks": [
          {
            "type": "command",
            "command": "#!/bin/bash\ninput=$(cat)\nfile_path=$(echo \"$input\" | jq -r '.tool_input.file_path // \"\"')\n\nif [ -n \"$file_path\" ] && [ -f \"$file_path\" ]; then\n  logger_info=$(grep -n '_logger.info' \"$file_path\" 2>/dev/null || true)\n  \n  if [ -n \"$logger_info\" ]; then\n    echo \"[Hook] WARNING: _logger.info found in $file_path\" >&2\n    echo \"$logger_info\" | head -5 >&2\n    echo \"[Hook] Consider using _logger.debug instead\" >&2\n  fi\nfi\n\necho \"$input\""
          }
        ],
        "description": "Warn about _logger.info usage - prefer _logger.debug"
      },
      {
        "matcher": "tool == \"Edit\" && tool_input.file_path matches \"models/.*\\\\.py$\"",
        "hooks": [
          {
            "type": "command",
            "command": "#!/bin/bash\ninput=$(cat)\nfile_path=$(echo \"$input\" | jq -r '.tool_input.file_path // \"\"')\n\nif [ -n \"$file_path\" ] && [ -f \"$file_path\" ]; then\n  if grep -q '_name\\s*=' \"$file_path\" 2>/dev/null; then\n    if ! grep -q '_description' \"$file_path\" 2>/dev/null; then\n      echo \"[Hook] WARNING: Model in $file_path missing _description attribute\" >&2\n    fi\n  fi\nfi\n\necho \"$input\""
          }
        ],
        "description": "Check for missing _description on Odoo models"
      },
      {
        "matcher": "tool == \"Edit\" && tool_input.file_path matches \"\\\\.py$\"",
        "hooks": [
          {
            "type": "command",
            "command": "#!/bin/bash\ninput=$(cat)\nfile_path=$(echo \"$input\" | jq -r '.tool_input.file_path // \"\"')\n\nif [ -n \"$file_path\" ] && [ -f \"$file_path\" ]; then\n  print_stmts=$(grep -n '^[^#]*print(' \"$file_path\" 2>/dev/null || true)\n  \n  if [ -n \"$print_stmts\" ]; then\n    echo \"[Hook] WARNING: print() found in $file_path\" >&2\n    echo \"$print_stmts\" | head -5 >&2\n    echo \"[Hook] Use _logger.debug instead of print()\" >&2\n  fi\nfi\n\necho \"$input\""
          }
        ],
        "description": "Warn about print() statements in Python files"
      },
      {
        "matcher": "tool == \"Edit\" && tool_input.file_path matches \"\\\\.xml$\"",
        "hooks": [
          {
            "type": "command",
            "command": "#!/bin/bash\ninput=$(cat)\nfile_path=$(echo \"$input\" | jq -r '.tool_input.file_path // \"\"')\n\nif [ -n \"$file_path\" ] && [ -f \"$file_path\" ]; then\n  if command -v xmllint >/dev/null 2>&1; then\n    xmllint --noout \"$file_path\" 2>&1 | head -5 >&2 || true\n  fi\nfi\n\necho \"$input\""
          }
        ],
        "description": "Validate XML syntax after editing Odoo views"
      }
    ],
    "Stop": [
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "#!/bin/bash\ninput=$(cat)\n\nif git rev-parse --git-dir > /dev/null 2>&1; then\n  modified_files=$(git diff --name-only HEAD 2>/dev/null | grep -E '\\.py$' || true)\n  \n  if [ -n \"$modified_files\" ]; then\n    has_print=false\n    while IFS= read -r file; do\n      if [ -f \"$file\" ]; then\n        if grep -q '^[^#]*print(' \"$file\" 2>/dev/null; then\n          echo \"[Hook] WARNING: print() found in $file\" >&2\n          has_print=true\n        fi\n      fi\n    done <<< \"$modified_files\"\n    \n    if [ \"$has_print\" = true ]; then\n      echo \"[Hook] Remove print() statements before committing\" >&2\n    fi\n  fi\nfi\n\necho \"$input\""
          }
        ],
        "description": "Final audit for print() in modified Python files before session ends"
      },
      {
        "matcher": "*",
        "hooks": [
          {
            "type": "command",
            "command": "#!/bin/bash\ninput=$(cat)\n\nif git rev-parse --git-dir > /dev/null 2>&1; then\n  modified_files=$(git diff --name-only HEAD 2>/dev/null | grep -E '\\.py$' || true)\n  \n  if [ -n \"$modified_files\" ]; then\n    while IFS= read -r file; do\n      if [ -f \"$file\" ]; then\n        if grep -q '\\.sudo()' \"$file\" 2>/dev/null; then\n          if ! grep -q '#.*[Ss]udo' \"$file\" 2>/dev/null; then\n            echo \"[Hook] WARNING: Undocumented sudo() usage in $file\" >&2\n          fi\n        fi\n      fi\n    done <<< \"$modified_files\"\n  fi\nfi\n\necho \"$input\""
          }
        ],
        "description": "Check for undocumented sudo() usage before session ends"
      }
    ]
  }
}
